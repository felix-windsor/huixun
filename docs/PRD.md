# 产品需求文档（PRD）：AI 驱动智能学习管理系统（LMS）

## 产品背景与目标
- 背景：高校与企业培训的课程内容日益复杂，传统题库维护成本高且更新慢，难以针对不同知识点进行精准评估。PDF 教材与资料广泛存在但结构化程度低。
- 目标：
  - 将 PDF 等文档内容自动结构化，抽取关键知识点与语义片段
  - 基于解析内容自动生成高质量试题，并进行难度分级与知识点标注
  - 提供课程管理、题库管理、评估分析的完整闭环，实现学习效果的可度量与可提升
  - 支持 1000+ 并发用户，保证良好性能、稳定性与可观测性

## 用户与角色
- 管理员（ADMIN）：系统配置与运维、用户与角色管理、全局审计
- 讲师/教务（INSTRUCTOR）：课程创建与维护、上传教材、生成与编辑试题、发布测评、查看分析报表
- 学员（STUDENT）：选课学习、参与测评、查看评估报告与学习建议

## 关键痛点与机会
- 痛点：教材内容难以结构化、题库维护困难、评估不精准、数据孤岛
- 机会：利用 LLM + 向量检索构建内容理解与题目生成的自动化流程，提升试题质量与评估准确性

## 核心使用场景与用户故事
- 上传教材
  - 作为讲师，我希望上传 PDF 教材，系统自动解析章节与关键点，以便后续生成试题。
- 生成试题
  - 作为讲师，我希望基于教材片段快速生成多种题型（单选/多选/判断/简答），并自动给出难度与知识点标签。
- 试题编辑与发布
  - 作为讲师，我希望在生成后可批量审阅与微调，最终发布为测评，并面向指定课程、班级开放。
- 学员测评
  - 作为学员，我希望参与测评并获得知识点掌握度的可视化报告与学习路线建议。
- 课程与题库管理
  - 作为讲师/管理员，我希望便捷管理课程、题库、知识点，支撑长期内容迭代。
- 数据分析
  - 作为讲师，我希望查看课程维度与知识点维度的掌握度趋势、试题难度分布、错误聚类与学习建议。

## 需求范围与优先级（MVP → 增强）
- MVP（高优先级）
  - PDF 上传与解析：上传、进度追踪、章节与片段抽取
  - 内容分析流水线：文本清洗、分块、嵌入生成、向量入库
  - AI 试题生成：单选/多选/判断/简答，难度分级与知识点标注
  - 题库管理：试题列表、筛选、编辑、发布为测评（Quiz）
  - 课程管理：创建/编辑课程，绑定测评
  - 学员测评：作答、提交、报告生成（正确率、知识点掌握度）
  - 基础分析：课程/知识点维度概览图表
  - 认证与权限：登录注册、JWT、RBAC（三角角色）
  - 日志与错误处理：统一异常、结构化日志、基础指标
- 增强（中优先级）
  - OCR 支持（扫描件）、断点续传与秒传、WebSocket 推送进度
  - 试题质量自检与二次纠错、题目去重与多样性增强
  - 题目导入导出（CSV/JSON）、题库版本与变更审计
  - 学习路径智能建议、错误聚类分析、知识点图谱
  - 多租户与班级分组、通知与消息中心

## 详细功能需求
- PDF 内容处理
  - 上传：支持拖拽、进度显示、大小限制、文件类型校验
  - 解析：提取文本、页码、标题层级，生成 `ContentFragment`（含 metadata）
  - 异步处理：解析与嵌入生成异步执行，前端查看进度
- AI 试题生成
  - 题型：单选/多选/判断/简答；可配置生成数量/题型比例
  - 格式：LLM 输出符合 JSON Schema；解析失败自动重试与自我纠错
  - 难度：`Easy/Medium/Hard`，依据 Bloom 认知层级与片段复杂度
  - 标签：知识点自动识别并绑定；支持手工修订
- 题库管理与测评
  - 列表与筛选：按课程、知识点、难度、状态
  - 编辑与审阅：题干、选项、答案、解析、难度与标签
  - 测评发布：组卷规则（题型占比、数量、难度阈值），生效时间与对象范围
- 学员评估与报告
  - 作答流程：开始测评、计时、提交、服务器端评分（客观题自动判分）
  - 报告：总体正确率、难度曲线、知识点掌握度、建议与下一步
- 课程管理
  - 课程创建/编辑/删除、讲师绑定、测评关联
- 数据分析与可视化
  - 课程维度：参与度、通过率、题目质量指标
  - 知识点维度：掌握度趋势、薄弱点聚类

## 数据与模型需求（概述）
- 核心实体（至少 6）：`User`、`Course`、`Quiz`、`Question`、`KnowledgePoint`、`ContentFragment`
- 扩展实体：`Enrollment`（选课）、`Attempt`（测评记录）
- 向量检索：`ContentFragment.embedding` 存储并建立近似最近邻索引
- 审计：操作日志、软删除、乐观锁

## 业务流程（MVP）
- 讲师上传 PDF → 后端入库与解析 → 生成 `ContentFragment` 与向量 → 讲师选择片段范围 → 触发 AI 试题生成 → 讲师审阅微调 → 发布测评 → 学员作答 → 报告与分析

## 界面与交互需求
- 后台端：仪表盘、课程管理、PDF 上传与解析进度、题库管理、测评发布、分析报表
- 学员端：课程列表、测评入口、作答界面、评估报告
- 响应式设计：栅格与断点；移动端作答体验优化（大按钮、滚动分页）

## 非功能需求
- 性能：并发 1000+ 用户；95% 响应延迟满足服务级别（例如 < 300ms 对常规读接口）
- 可用性：核心功能可用性 ≥ 99.9%（生产）；失败重试与幂等保障
- 安全：JWT、RBAC、输入校验、速率限制、HTTPS；隐私数据不入日志
- 观测：请求/队列/嵌入耗时/LLM 成本等关键指标；错误报警
- 测试：单元测试覆盖率 ≥ 80%，集成测试验证端到端；前端组件单测

## 指标与度量
- 内容解析：解析成功率、平均解析耗时、OCR 命中率（可选）
- 试题生成：格式一致性率、纠错率、重复率、平均生成耗时、难度分布合理性
- 学员评估：参与率、完成率、正确率、知识点掌握度提升
- 系统性能：吞吐/QPS、P95/P99 延迟、资源利用率、错误率

## 范围不包含（MVP）
- 作业编程题自动判分、实验环境沙箱
- 实时互动课堂/直播
- 多租户计费与发票系统

## 风险与假设
- LLM 成本与吞吐受供应商限制 → 需速率限制与缓存
- PDF 质量差（扫描件、复杂排版） → 需 OCR 与回退策略
- 向量检索精度与速度权衡 → 需索引参数调优

## 验收标准
- PRD 对应的功能清单均实现，接口与前端满足使用场景
- 单元测试覆盖率 ≥ 80%（CI 强制），性能压测达到并发 1000+ 目标
- 完整错误处理与日志链路，核心流程可观测与可追踪
- 响应式前端适配桌面/移动端，关键流程无阻塞

## 交付物
- 文档：PRD、架构与设计、数据模型、API 文档（OpenAPI）、部署与运维手册
- 测试与性能：覆盖率报告、压测报告、问题清单与修复说明
- 演示：最小闭环演示（上传→解析→生成→预览→评估）

